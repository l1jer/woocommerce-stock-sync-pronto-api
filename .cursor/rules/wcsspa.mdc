---
description: WordPress, WooCommerce, and PHP development rules for stock sync plugin
globs: 
  - "**/*.php"
  - "**/woocommerce-stock-sync-pronto-avenue-api.php"
  - "**/includes/**/*.php"
  - "**/templates/**/*.php"
alwaysApply: true
---

You are an expert in WordPress, WooCommerce, PHP, and related web development technologies.

## Key Principles

- Write concise, technical code with accurate PHP examples
- Follow WordPress and WooCommerce coding standards and best practices
- Use object-oriented programming when appropriate, focusing on modularity
- Prefer iteration and modularisation over duplication
- Use descriptive function, variable, and file names
- Use lowercase with hyphens for directories (e.g., wp-content/themes/my-theme, wp-content/plugins/my-plugin)
- Favour hooks (actions and filters) for extending functionality
- When a task is completed, update version numbers everywhere and add proper changelog in README

## PHP/WordPress/WooCommerce Standards

- Ensure PHP code meets PHP 8.2+ requirements
- Always test against latest WordPress and WooCommerce versions
- Use PHP 8.2+ features when appropriate (typed properties, arrow functions)
- Follow WordPress PHP Coding Standards
- Use strict typing: `declare(strict_types=1);`
- Utilise WordPress core functions and APIs when available
- Follow WordPress theme and plugin directory structures and naming conventions

## Error Handling and Security

- Implement proper error handling and logging using WordPress debug logging features
- Create custom error handlers when necessary
- Use try-catch blocks for expected exceptions
- Use WordPress built-in functions for data validation and sanitisation
- Implement proper nonce verification for form submissions
- Use WordPress database abstraction layer (wpdb) for database interactions
- Use `prepare()` statements for secure database queries
- Implement proper database schema changes using `dbDelta()` function

## Dependencies

- WordPress (latest stable version)
- WooCommerce (latest stable version)
- Composer for dependency management (when building advanced plugins or themes)

## WordPress Best Practices

- Use WordPress hooks (actions and filters) instead of modifying core files
- Implement proper theme functions using functions.php
- Use WordPress built-in user roles and capabilities system
- Utilise WordPress transients API for caching
- Implement background processing for long-running tasks using `wp_cron()`
- Use WordPress built-in testing tools (WP_UnitTestCase) for unit tests
- Implement proper internationalisation and localisation using WordPress i18n functions
- Implement proper security measures (nonces, data escaping, input sanitisation)
- Use `wp_enqueue_script()` and `wp_enqueue_style()` for proper asset management
- Implement custom post types and taxonomies when appropriate
- Use WordPress built-in options API for storing configuration data
- Implement proper pagination using functions like `paginate_links()`

## WooCommerce Best Practices

- Leverage action and filter hooks provided by WooCommerce for extensibility
- Adhere to WooCommerce coding standards in addition to WordPress standards
- Use WooCommerce naming conventions for functions and variables
- Use built-in WooCommerce functions instead of reinventing functionality
  - Example: `wc_get_product()` instead of `get_post()` for retrieving products
- Use WooCommerce Settings API for plugin configuration pages
- Integrate settings seamlessly into WooCommerce admin interface
- Override WooCommerce templates in your plugin for custom layouts
- Place overridden templates in `your-plugin/woocommerce/` directory
- Use WooCommerce CRUD classes and data stores for managing custom data
- Extend existing data stores for custom functionality
- Use WooCommerce session handling for storing temporary data
  - Example: `WC()->session->set('your_key', 'your_value');`
- Follow WooCommerce API structure and conventions when extending REST API
- Use proper authentication and permission checks
- Use WooCommerce notice system for user-facing messages
  - Example: `wc_add_notice('Your message', 'error');`
- Extend WooCommerce email system for custom notifications using `WC_Email` class
- Check for WooCommerce activation and version compatibility
- Gracefully disable functionality if requirements aren't met
- Use WooCommerce translation functions for text strings
- Support RTL languages in plugin CSS
- Utilise WooCommerce logging system for debugging
  - Example: `wc_get_logger()->debug('Your debug message', array('source' => 'your-plugin'));`

## Key Conventions

1. Follow WordPress plugin API for extending functionality
2. Use WordPress template hierarchy for theme development
3. Implement proper data sanitisation and validation using WordPress functions
4. Use WordPress template tags and conditional tags in themes
5. Implement proper database queries using $wpdb or WP_Query
6. Use WordPress authentication and authorisation functions
7. Implement proper AJAX handling using admin-ajax.php or REST API
8. Use WordPress hook system for modular and extensible code
9. Implement proper database operations using WordPress transactional functions
10. Use WordPress WP_Cron API for scheduling tasks

## Language and Style Guidelines

- Use British/Australian English for all code, comments, and documentation
- Follow British/Australian English spelling, grammar, and formatting conventions
- Write in standard technical English for clarity and precision
- Include comprehensive debugging statements and technical comments
- Use yarn as the package manager (not npm)

## Plugin-Specific Guidelines

- Maintain compatibility with WooCommerce Stock Sync with Pronto Avenue API plugin structure
- Follow established naming conventions for functions prefixed with `wc_sspaa_`
- Implement proper API rate limiting and error handling for external API calls
- Use WordPress cron for scheduled synchronisation tasks
- Implement proper logging for stock synchronisation operations
- Handle GTIN synchronisation from API APN field appropriately
- Maintain 14-day log file retention policy
- Exclude specified SKUs from synchronisation process as defined in constants
